# docker-compose.yml

version: '3.8'

services:
  mongo:
    image: mongo
    container_name: ar-memo-mongo-compose
    # ğŸ‘‡ ì´ ë¶€ë¶„ì„ ì¶”ê°€í•´ ì£¼ì„¸ìš”.
    ports:
      - "27017:27017" # ì»¨í…Œì´ë„ˆì˜ 27017 í¬íŠ¸ë¥¼ ë‚´ PCì˜ 27017 í¬íŠ¸ë¡œ ì—°ê²°
    volumes:
      - mongo-data:/data/db
    restart: unless-stopped

  # 2. ë°±ì—”ë“œ ì„œë¹„ìŠ¤ ì„¤ì •
  backend:
    container_name: ar-memo-backend-compose
    build: . # í˜„ì¬ ë””ë ‰í† ë¦¬ì˜ Dockerfileì„ ì‚¬ìš©í•´ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œ
    ports:
      - "4000:4000" # í¬íŠ¸ ë§¤í•‘
    volumes:
      # ì¤‘ìš”: ë‚´ ì»´í“¨í„°ì˜ src í´ë”ë¥¼ ì»¨í…Œì´ë„ˆì˜ /app/src í´ë”ì™€ ë™ê¸°í™”
      # ì´ë ‡ê²Œ í•˜ë©´ ì½”ë“œë¥¼ ì €ì¥í•  ë•Œë§ˆë‹¤ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ì½”ë“œë„ ë°”ë¡œ ë³€ê²½ë¨
      - ./src:/app/src
    environment:
      # í•„ìš”í•œ í™˜ê²½ ë³€ìˆ˜ë“¤ì„ ì—¬ê¸°ì— ëª¨ë‘ ì •ì˜
      - MONGODB_URI=mongodb://mongo:27017/ar-memo
      - JWT_SECRET=your-super-secret-key-for-dev
      - PORT=4000
    command: npm run dev # ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ì‹œ 'node src/server.js' ëŒ€ì‹  'nodemon'ì„ ì‹¤í–‰
    depends_on:
      - mongo # mongo ì„œë¹„ìŠ¤ê°€ ë¨¼ì € ì‹œì‘ëœ í›„ì— backend ì„œë¹„ìŠ¤ë¥¼ ì‹œì‘

# MongoDB ë°ì´í„°ë¥¼ ë³´ê´€í•  ë³¼ë¥¨ ì •ì˜
volumes:
  mongo-data: